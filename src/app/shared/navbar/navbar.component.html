<nav class="text-teal-600 bg-white px-6 py-4 flex justify-between items-center h-[10vh] relative z-10">
  <div class="nav-brand flex items-center justify-center md:w-[10%]">
    <a class="block text-white" href="#">
      <span class="sr-only">Home</span>
      <svg width="100" height="97" viewBox="0 0 203 97" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M37.088 96.28C30.0053 96.28 23.6907 94.744 18.144 91.672C12.6827 88.6 8.33067 84.4187 5.088 79.128C1.93067 73.8373 0.352 67.7787 0.352 60.952C0.352 54.1253 1.93067 48.0667 5.088 42.776C8.33067 37.4853 12.6827 33.304 18.144 30.232C23.6907 27.16 30.0053 25.624 37.088 25.624C44.1707 25.624 50.4427 27.16 55.904 30.232C61.4507 33.304 65.8027 37.4853 68.96 42.776C72.1173 48.0667 73.696 54.1253 73.696 60.952C73.696 67.7787 72.1173 73.8373 68.96 79.128C65.8027 84.4187 61.4507 88.6 55.904 91.672C50.4427 94.744 44.1707 96.28 37.088 96.28ZM37.088 78.616C40.16 78.616 42.8907 77.848 45.28 76.312C47.6693 74.776 49.5467 72.6853 50.912 70.04C52.2773 67.3947 52.9173 64.3653 52.832 60.952C52.9173 57.5387 52.2773 54.5093 50.912 51.864C49.5467 49.1333 47.6693 47 45.28 45.464C42.8907 43.928 40.16 43.16 37.088 43.16C34.016 43.16 31.2427 43.928 28.768 45.464C26.3787 47 24.5013 49.1333 23.136 51.864C21.7707 54.5093 21.1307 57.5387 21.216 60.952C21.1307 64.3653 21.7707 67.3947 23.136 70.04C24.5013 72.6853 26.3787 74.776 28.768 76.312C31.2427 77.848 34.016 78.616 37.088 78.616ZM104.112 96.28C96.6027 96.28 90.0747 94.7867 84.528 91.8C78.9813 88.728 74.672 84.5893 71.6 79.384C68.528 74.0933 66.992 68.0773 66.992 61.336C66.992 56.1307 67.8453 51.352 69.552 47C71.2587 42.648 73.648 38.8933 76.72 35.736C79.792 32.4933 83.4187 30.0187 87.6 28.312C91.8667 26.52 96.5173 25.624 101.552 25.624C106.331 25.624 110.683 26.4773 114.608 28.184C118.619 29.8907 122.075 32.28 124.976 35.352C127.877 38.424 130.096 42.0507 131.632 46.232C133.168 50.4133 133.851 54.9787 133.68 59.928L133.552 65.432H79.408L76.464 53.912H116.912L114.736 56.344V53.784C114.565 51.6507 113.883 49.7733 112.688 48.152C111.579 46.4453 110.085 45.1227 108.208 44.184C106.331 43.2453 104.197 42.776 101.808 42.776C98.48 42.776 95.6213 43.4587 93.232 44.824C90.928 46.104 89.1787 48.024 87.984 50.584C86.7893 53.0587 86.192 56.1307 86.192 59.8C86.192 63.5547 86.96 66.84 88.496 69.656C90.1173 72.3867 92.4213 74.52 95.408 76.056C98.48 77.592 102.107 78.36 106.288 78.36C109.189 78.36 111.749 77.9333 113.968 77.08C116.272 76.2267 118.747 74.776 121.392 72.728L130.992 86.296C128.347 88.6 125.531 90.4773 122.544 91.928C119.557 93.3787 116.485 94.4453 113.328 95.128C110.256 95.896 107.184 96.28 104.112 96.28ZM172.2 96.408C169.128 96.408 166.184 95.9813 163.368 95.128C160.552 94.2747 157.992 93.1227 155.688 91.672C153.469 90.2213 151.592 88.5573 150.056 86.68C148.605 84.7173 147.624 82.712 147.112 80.664L151.592 79.128L150.44 94.872H131.368V0.279999H151.976V43.288L147.752 41.752C148.264 39.5333 149.245 37.4853 150.696 35.608C152.147 33.6453 153.981 31.9387 156.2 30.488C158.419 28.952 160.851 27.7573 163.496 26.904C166.141 26.0507 168.872 25.624 171.688 25.624C177.576 25.624 182.781 27.16 187.304 30.232C191.912 33.2187 195.539 37.4 198.184 42.776C200.829 48.0667 202.152 54.1253 202.152 60.952C202.152 67.864 200.829 74.008 198.184 79.384C195.624 84.6747 192.083 88.856 187.56 91.928C183.037 94.9147 177.917 96.408 172.2 96.408ZM166.824 79.128C169.896 79.128 172.584 78.36 174.888 76.824C177.192 75.288 178.941 73.1973 180.136 70.552C181.416 67.8213 182.056 64.6213 182.056 60.952C182.056 57.368 181.416 54.2107 180.136 51.48C178.941 48.7493 177.192 46.6587 174.888 45.208C172.584 43.7573 169.896 43.032 166.824 43.032C163.667 43.032 160.936 43.7573 158.632 45.208C156.328 46.6587 154.536 48.7493 153.256 51.48C151.976 54.2107 151.336 57.368 151.336 60.952C151.336 64.6213 151.976 67.8213 153.256 70.552C154.536 73.1973 156.328 75.288 158.632 76.824C160.936 78.36 163.667 79.128 166.824 79.128Z" fill="#1B999F"/>
          </svg>
  </a>
  </div>


  <!-- Bouton hamburger (mobile) -->
  <button class="relative w-6 h-6 md:hidden focus:outline-none" (click)="toggleMenu()" aria-label="Menu">
    <!-- Ligne 1 -->
    <span [ngClass]="{
      'rotate-45': isMenuOpen,
      'translate-y-[-8px]': !isMenuOpen
    }"
      class="absolute left-0 top-1/2 w-full h-0.5 bg-teal-600 transform transition-all duration-300 ease-in-out origin-center"></span>

    <!-- Ligne 2 -->
    <span [ngClass]="{
      'opacity-0': isMenuOpen,
      'opacity-100': !isMenuOpen
    }"
      class="absolute mt-[1px] left-0 top-1/2 w-full h-0.5 bg-teal-600 transform -translate-y-1/2 transition-opacity duration-200 ease-in-out"></span>

    <!-- Ligne 3 -->
    <span [ngClass]="{
      '-rotate-45': isMenuOpen,
      'translate-y-[8px]': !isMenuOpen
    }"
      class="absolute left-0 top-1/2 w-full h-0.5 bg-teal-600 transform transition-all duration-300 ease-in-out origin-center"></span>
  </button>


  <!-- Version mobile -->
  <div *ngIf="isMenuOpen || isAnimating"
    [ngClass]="
  'absolute top-full left-0 w-full bg-teal-600 text-white p-4 flex flex-col md:flex-row md:static md:flex md:w-auto md:space-x-4 md:p-0 ' + menuAnimationClass">
    <!-- <a routerLink="/tasks" routerLinkActive="underline font-semibold" class="py-2">Tâches</a> -->
    <!-- <a routerLink="/categories" routerLinkActive="underline font-semibold" class="py-2">Catégories</a> -->
    <!-- <a routerLink="/auth/login" routerLinkActive="underline">Se connecter</a> -->
     <div class="flex flex-row items-center justify-center gap-5">
      <a [routerLink]="['/cart']" routerLinkActive="underline font-semibold">
        <span class="material-icons no-underline" [matBadge]="cartLength$ | async" matBadgeColor="primary"
          matBadgeOverlap="false">
          shopping_cart
        </span></a>

      <a *ngIf="authService.isLoggedIn$ | async " routerLinkActive="underline font-semibold"
        class="cursor-pointer pl-2 py-2"> <span class="material-icons" [title]=getUsername()>
          account_circle
        </span></a>
     </div>

    <hr>
    <div class="relative group">
      <button class="py-2 hover:underline" (click)="isCategoryMobileOpen = !isCategoryMobileOpen">
        Catégories
      </button>

      <div *ngIf="isCategoryMobileOpen" class="pl-4 space-y-1 my-4">
        <a *ngFor="let cat of categories" [routerLink]="['/categories', cat.slug]"
          routerLinkActive="bg-white text-teal-600 font-semibold"
          class="flex flex-row border items-center justify-between capitalize px-4 py-2" (click)="closeMobileMenu()">
          {{ cat.name }}
          <span class="material-icons no-underline">chevron_right</span>
        </a>

      </div>
    </div>
    <hr>
    <a *ngIf="!(authService.isLoggedIn$ | async)" routerLink="/auth/login" class="py-2">Se connecter</a>
    <a *ngIf="authService.isLoggedIn$ | async" (click)="logout()" class="cursor-pointer py-2">Se déconnecter</a>
    <a *ngIf="authService.isLoggedIn$ | async" routerLink="/dashboard" class="py-2">Dashboard</a>



  </div>

  <!-- Version Desktop -->
  <div
    class="absolute top-full left-0 w-full bg-whitte text-teal-600 p-4 hidden md:flex-row md:static md:flex md:w-auto md:space-x-4 md:p-0 md:items-center">

    <!-- <a routerLink="/tasks" routerLinkActive="underline font-semibold" class="py-2">Tâches</a> -->

    <!-- <a routerLink="/categories" routerLinkActive="underline font-semibold" class="py-2">Catégories</a> -->

    <div class="relative border">
      <div class="group inline-block">
        <button class="py-2 px-4 hover:underline border">
          Catégories
        </button>

        <!-- Le dropdown doit être un enfant de .group -->
        <div
          class="absolute left-0 pt-1 w-48 bg-white text-black rounded shadow-lg
                 opacity-0 transform -translate-y-2 transition-all duration-500 z-50
                 group-hover:opacity-100 group-hover:translate-y-0 pointer-events-none group-hover:pointer-events-auto">
          <a *ngFor="let cat of categories" [routerLink]="['/categories', cat.slug]"
            routerLinkActive="underline font-semibold" class="block px-4 py-2 hover:bg-indigo-100 capitalize">
            {{ cat.name }}
          </a>
        </div>
      </div>
    </div>


    <a *ngIf="authService.isLoggedIn$ | async" routerLink="/dashboard" routerLinkActive="underline font-semibold"
      class="py-2">Administration</a>

    <a *ngIf="!(authService.isLoggedIn$ | async)" routerLink="/auth/login" routerLinkActive="underline font-semibold"
      class="py-2">Se connecter</a>
    <a *ngIf="authService.isLoggedIn$ | async" (click)="logout()" routerLinkActive="underline font-semibold"
      class="cursor-pointer py-2">Se déconnecter</a>

    <a [routerLink]="['/cart']" routerLinkActive="underline font-semibold">
      <span class="material-icons no-underline" [matBadge]="cartLength$ | async" matBadgeColor="primary"
        matBadgeOverlap="false">
        shopping_cart
      </span></a>

    <a *ngIf="authService.isLoggedIn$ | async " routerLinkActive="underline font-semibold"
      class="cursor-pointer pl-4 py-2"> <span class="material-icons" [title]=getUsername()>
        account_circle
      </span></a>
  </div>


</nav>