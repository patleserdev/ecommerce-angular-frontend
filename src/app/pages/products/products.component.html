<div *ngIf="isLoading" class="border-red-500 flex items-center justify-center p-2 mb-2"><mat-spinner></mat-spinner>
</div>

<div *ngIf="!isLoading && product" class="p-4 md:p-16">
  <div class="bg-teal-600 text-white p-2 mb-2">
    <p class="text-xl capitalize italic">{{product?.category?.name}}</p>
  </div>
  <div class="flex flex-col md:flex-row justify-between gap-20">
    <div class="flex flex-col gap-2">
      <h3 class="text-xl capitalize bg-teal-300 p-2 my-2">{{product?.brand?.name}}</h3>
      <h2 class="text-2xl capitalize">{{product?.name}}</h2>


      <p>{{product?.description}}</p>

      <hr class="my-5">
      <p class="font-semibold mt-5">Modèles disponibles</p>

      <div *ngFor="let variation of product?.variations"
        class="flex flex-row flex-wrap md:flex-nowrap justify-between border rounded gap-1"
        [class.opacity-50]="variation.stock === 0" [class.pointer-events-none]="variation.stock === 0">
        <span class="capitalize w-20">{{variation?.gender}}</span>
        <span class="uppercase w-20">{{variation?.size}}</span>
        <span class="uppercase px-5" [style.backgroundColor]="variation.color"></span>
        <span class="uppercase px-2">{{variation.stock >= 1 ? "Disponible" : "Pas de stock" }}</span>
        <span (click)="addProductToCart(product,variation)"
          class="material-symbols-outlined no-underline flex items-center opacity-50 hover:opacity-100 transition-all cursor-pointer">{{variation.stock
          >= 1 ? "add_shopping_cart" : "&nbsp;" }}</span>
        <span (click)="deleteProductFromCart(product.id,variation.id)"
          class="material-icons no-underline flex items-center opacity-50 hover:opacity-100 transition-all cursor-pointer">{{variation.stock
          >= 1 ? "remove_shopping_cart" : "&nbsp;" }}</span>

      </div>

      <p class="text-3xl">{{product?.price}} €</p>
    </div>
    <div *ngIf="product && product.medias.length > 0" class="flex flex-col gap-5">
      <div class="firstImage relative w-full h-[400px] overflow-hidden">
        <img
          *ngFor="let media of product.medias; let i = index"
          [src]="media.url"
          [class.opacity-100]="i === firstMedia"
          [class.opacity-0]="i !== firstMedia"
          class="transition-opacity duration-500 absolute top-0 left-0 w-full h-full object-contain"
        />
      </div>
      <div class="flex flex-row gap-2 items-center justify-center" *ngIf="product && product.medias.length > 0">
        <span class="material-icons no-underline cursor-pointer" (click)="prevImage()">chevron_left</span>
        <img [src]="media.url" *ngFor="let media of product.medias; let i = index" class="w-[15%] cursor-pointer border-2"
          (click)="selectImage(i)" [class.border-blue-500]="i === firstMedia" />
        <span class="material-icons no-underline cursor-pointer" (click)="nextImage()">chevron_right</span>
      </div>

      <!-- Sinon, message s'il n'y a pas de médias -->
      <div *ngIf="product && product.medias.length == 0" class="text-gray-500">
        Aucun média lié à ce produit.
      </div>

    </div>
  </div>





</div>